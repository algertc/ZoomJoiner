'''
Written by Nathan Hoisington
originally Designed to be inherited by VBA_support.py
need win32gui and dll_functions imported to  work
'''
import win32gui
from  windows_gui_automation.dll_functions import *
class findWindowElements(object):
    '''
    class for finding all elements in a parent window
    '''
    def __init__(self):
        self.WindowElements = {}
    def CallBackFunction(self,
                         hwnd,
                         args###this is your filter term,
                         ):
        #print ('callback')
        CLASS = win32gui.GetClassName(hwnd)
        NAME = win32gui.GetWindowText(hwnd)
        #print ('CLASS',CLASS)
        #print ('NAME', NAME)
        pos = RECT()
        #print('pos', pos)
        GetWindowRect(hwnd,addressof(pos) )
        xcor = (pos.top + pos.bottom)/2
        ycor = (pos.right + pos.left)/2
        place = (int(xcor) & 0xffff) | ((int(ycor) & 0xffff) << 16)
        #print (place)
        if CLASS.lower() not in args:
            
            self.WindowElements[hwnd] = {'name' : NAME,
                                         'class' : CLASS,
                                         'pos':place}
    def ListWindows(self,
                    startWindow,
                    args):
        win32gui.EnumChildWindows(startWindow, self.CallBackFunction,args)

